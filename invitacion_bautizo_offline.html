<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Invitación Bautizo de Jose Mathias (Versión Offline)</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      background: #f5f7fa;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      font-family: 'Helvetica Neue', Arial, sans-serif;
      padding: 20px;
    }
    
    .container {
      position: relative;
      max-width: 100%;
      height: auto;
    }
    
    canvas {
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.15);
      border-radius: 10px;
      max-width: 100%;
      height: auto;
      display: block;
    }
    
    /* Responsive styles */
    @media screen and (max-width: 840px) {
      .container {
        width: 95%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Imagen original que se usará como respaldo -->
    <img id="babyImage" src="iCloud Photos from Helbs LozRoj/89403b46-9e13-4d3e-b6f6-b17c5359e2e6.jpg" alt="Jose Mathias" style="display: none;">
    
    <canvas id="baptismCanvas" width="800" height="1200"></canvas>
    <noscript>Tu navegador no soporta JavaScript. Por favor, habilita JavaScript para ver esta invitación.</noscript>
    <div id="fallbackMessage" style="display: none; text-align: center; padding: 20px; color: #333;">
      <h1>Invitación Bautizo de Jose Mathias</h1>
      <p style="font-style: italic;">Con inmensa alegría, queremos compartir contigo un momento muy especial en nuestras vidas.</p>
      <p><strong>El Bautizo de nuestro hijo, Jose Mathias.</strong></p>
      <img src="iCloud Photos from Helbs LozRoj/89403b46-9e13-4d3e-b6f6-b17c5359e2e6.jpg" alt="Jose Mathias" style="max-width: 100%; height: auto; margin: 20px 0; border: 8px solid white; box-shadow: 0 4px 8px rgba(0,0,0,0.2);">
      
      <p>Fecha: Viernes, 6 de septiembre de 2025<br>
      Hora: 12:00 del día<br>
      Lugar: Parroquia de San Ginés<br>
      Dirección: Plaza de las Palmas, 1</p>
      <p>Padres: José y Victoria | Padrinos: Humberto y Ángela</p>
      <p style="font-style: italic;">Celebra con nosotros este momento lleno de fe, amor y esperanza, en el que una nueva luz se enciende en nuestro camino.</p>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('baptismCanvas');
    const ctx = canvas.getContext('2d');
    
    // Mantener aspect ratio en dispositivos móviles
    function resizeCanvas() {
      const container = document.querySelector('.container');
      const containerWidth = container.clientWidth;
      
      if (containerWidth < 800) {
        const aspectRatio = canvas.height / canvas.width;
        canvas.style.width = containerWidth + 'px';
        canvas.style.height = (containerWidth * aspectRatio) + 'px';
      } else {
        canvas.style.width = '';
        canvas.style.height = '';
      }
    }
    
    // Ejecutar al cargar y al cambiar tamaño de ventana
    window.addEventListener('load', resizeCanvas);
    window.addEventListener('resize', resizeCanvas);

    // Carga la imagen del bebé desde archivo local
    const img = new Image();
    img.src = 'iCloud Photos from Helbs LozRoj/89403b46-9e13-4d3e-b6f6-b17c5359e2e6.jpg';
    
    // Función para crear imagen placeholder solo si la imagen original no carga
    function createPlaceholderImage() {
      const placeholderCanvas = document.createElement('canvas');
      placeholderCanvas.width = 400;
      placeholderCanvas.height = 400;
      const pCtx = placeholderCanvas.getContext('2d');
      
      // Fondo azul claro
      pCtx.fillStyle = '#e6f0ff';
      pCtx.fillRect(0, 0, 400, 400);
      
      // Círculo para la cara
      pCtx.fillStyle = '#ffe0cc';
      pCtx.beginPath();
      pCtx.arc(200, 180, 100, 0, Math.PI * 2);
      pCtx.fill();
      
      // Ojos
      pCtx.fillStyle = '#4c4cff';
      pCtx.beginPath();
      pCtx.arc(170, 160, 12, 0, Math.PI * 2);
      pCtx.arc(230, 160, 12, 0, Math.PI * 2);
      pCtx.fill();
      
      // Sonrisa
      pCtx.strokeStyle = '#ff9999';
      pCtx.lineWidth = 5;
      pCtx.beginPath();
      pCtx.arc(200, 200, 40, 0.2, Math.PI - 0.2);
      pCtx.stroke();
      
      // Gorro de bautizo
      pCtx.fillStyle = '#ffffff';
      pCtx.beginPath();
      pCtx.ellipse(200, 100, 90, 50, 0, 0, Math.PI * 2);
      pCtx.fill();
      
      // Borde del gorro
      pCtx.strokeStyle = '#dddddd';
      pCtx.lineWidth = 3;
      pCtx.beginPath();
      pCtx.ellipse(200, 100, 90, 50, 0, 0, Math.PI * 2);
      pCtx.stroke();
      
      // Cruz en el gorro
      pCtx.strokeStyle = '#aaaaff';
      pCtx.lineWidth = 4;
      pCtx.beginPath();
      pCtx.moveTo(200, 80);
      pCtx.lineTo(200, 120);
      pCtx.moveTo(180, 100);
      pCtx.lineTo(220, 100);
      pCtx.stroke();
      
      // Cuerpo/Manta
      pCtx.fillStyle = '#ffffff';
      pCtx.beginPath();
      pCtx.moveTo(140, 280);
      pCtx.lineTo(260, 280);
      pCtx.lineTo(300, 380);
      pCtx.lineTo(100, 380);
      pCtx.closePath();
      pCtx.fill();
      
      // Bordes de la manta
      pCtx.strokeStyle = '#aaaaff';
      pCtx.lineWidth = 4;
      pCtx.beginPath();
      pCtx.moveTo(140, 280);
      pCtx.lineTo(260, 280);
      pCtx.lineTo(300, 380);
      pCtx.lineTo(100, 380);
      pCtx.closePath();
      pCtx.stroke();
      
      // Texto
      pCtx.fillStyle = '#8888ff';
      pCtx.font = 'italic 20px Arial';
      pCtx.textAlign = 'center';
      pCtx.fillText('Jose Mathias', 200, 350);
      
      return placeholderCanvas.toDataURL();
    }
    
    // Crea y asigna la imagen placeholder
    img.src = createPlaceholderImage();
    
    // Variables de posición y tamaño
    let imgX, imgY, imgW, imgH;

    // Dibuja fondo y rayos (estático)
    function drawBackground() {
      // Fondo radial celestial
      const grad = ctx.createRadialGradient(
        canvas.width/2, canvas.height/2, 50,
        canvas.width/2, canvas.height/2, 600
      );
      grad.addColorStop(0, 'rgba(255, 250, 240, 1)');
      grad.addColorStop(1, 'rgba(225, 235, 245, 1)');
      ctx.fillStyle = grad;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Bordes elegantes
      ctx.strokeStyle = 'rgba(200, 200, 220, 0.5)';
      ctx.lineWidth = 15;
      ctx.strokeRect(20, 20, canvas.width - 40, canvas.height - 40);
      
      // Segundo borde interior
      ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';
      ctx.lineWidth = 2;
      ctx.strokeRect(30, 30, canvas.width - 60, canvas.height - 60);

      // Rayos de luz
      ctx.save();
      ctx.translate(canvas.width/2, 200);
      for (let i = 0; i < 30; i++) {
        ctx.rotate((Math.PI*2) / 30);
        ctx.fillStyle = 'rgba(255, 255, 240, 0.1)';
        ctx.fillRect(-5, 0, 10, 700);
      }
      ctx.restore();
    }

    // Dibuja cruces celestiales en las esquinas con efecto 3D y resplandor
    function drawCornerCrosses(time = 0) {
      const crossSize = 34;
      const margin = 60;
      
      // Función para dibujar cruz con efecto 3D y resplandor celestial
      function drawCross(x, y, index) {
        const pulseIntensity = 0.15; // Intensidad del pulso
        const pulseFrequency = 0.001; // Frecuencia del pulso
        const pulseFactor = 1 + Math.sin((time || 0) * pulseFrequency + index) * pulseIntensity;
        
        // Resplandor celestial detrás de la cruz
        const glowSize = crossSize * 1.2 * pulseFactor;
        const glow = ctx.createRadialGradient(x, y, 0, x, y, glowSize);
        glow.addColorStop(0, `rgba(255, 255, 255, ${0.5 * pulseFactor})`);
        glow.addColorStop(0.5, `rgba(200, 220, 255, ${0.3 * pulseFactor})`);
        glow.addColorStop(1, 'rgba(180, 200, 255, 0)');
        
        ctx.fillStyle = glow;
        ctx.beginPath();
        ctx.arc(x, y, glowSize, 0, Math.PI * 2);
        ctx.fill();
        
        // Sombra para efecto 3D
        ctx.shadowColor = 'rgba(0, 0, 0, 0.15)';
        ctx.shadowBlur = 4;
        ctx.shadowOffsetX = 1.5;
        ctx.shadowOffsetY = 1.5;
        
        // Cruz principal con brillo celestial
        const gradientCross = ctx.createLinearGradient(
          x - crossSize/2, y - crossSize/2, 
          x + crossSize/2, y + crossSize/2
        );
        gradientCross.addColorStop(0, `rgba(220, 230, 255, ${0.9 * pulseFactor})`);
        gradientCross.addColorStop(0.5, `rgba(200, 220, 250, ${0.8 * pulseFactor})`);
        gradientCross.addColorStop(1, `rgba(180, 200, 240, ${0.7 * pulseFactor})`);
        
        ctx.strokeStyle = gradientCross;
        ctx.lineWidth = 3 * pulseFactor;
        
        ctx.beginPath();
        // Línea vertical
        ctx.moveTo(x, y - crossSize/2);
        ctx.lineTo(x, y + crossSize/2);
        // Línea horizontal
        ctx.moveTo(x - crossSize/2, y);
        ctx.lineTo(x + crossSize/2, y);
        ctx.stroke();
        
        // Centro brillante de la cruz
        ctx.shadowColor = 'transparent';
        const centerGlow = ctx.createRadialGradient(x, y, 0, x, y, 4 * pulseFactor);
        centerGlow.addColorStop(0, 'rgba(255, 255, 255, 1)');
        centerGlow.addColorStop(0.5, 'rgba(240, 250, 255, 0.8)');
        centerGlow.addColorStop(1, 'rgba(220, 240, 255, 0)');
        
        ctx.fillStyle = centerGlow;
        ctx.beginPath();
        ctx.arc(x, y, 4 * pulseFactor, 0, Math.PI * 2);
        ctx.fill();
        
        // Pequeños círculos en los extremos
        ctx.fillStyle = `rgba(240, 250, 255, ${0.9 * pulseFactor})`;
        
        // Extremos
        const endpoints = [
          {x: x, y: y - crossSize/2},
          {x: x, y: y + crossSize/2},
          {x: x - crossSize/2, y: y},
          {x: x + crossSize/2, y: y}
        ];
        
        endpoints.forEach(point => {
          ctx.beginPath();
          ctx.arc(point.x, point.y, 2 * pulseFactor, 0, Math.PI * 2);
          ctx.fill();
        });
      }
      
      // Cruces en las 4 esquinas con efecto de luz
      ctx.save();
      drawCross(margin, margin, 0); // Superior izquierda
      drawCross(canvas.width - margin, margin, 1); // Superior derecha
      drawCross(margin, canvas.height - margin, 2); // Inferior izquierda
      drawCross(canvas.width - margin, canvas.height - margin, 3); // Inferior derecha
      
      // Resetear sombra
      ctx.shadowColor = 'transparent';
      ctx.restore();
    }

    // Dibuja el contenido fijo (foto, dove, texto)
    function drawStaticElements() {
      // Título principal
      ctx.textAlign = 'center';
      ctx.fillStyle = '#365173';
      ctx.font = 'bold 42px "Georgia", serif';
      ctx.fillText('Bautizo', canvas.width/2, 120);
      
      // Nombre en estilo caligráfico
      ctx.font = 'italic bold 52px "Georgia", serif';
      ctx.fillStyle = '#2c3e50';
      ctx.fillText('Jose Mathias', canvas.width/2, 180);
      
      // Foto
      const targetW = 400;
      const scale = targetW / img.width;
      imgW = targetW;
      imgH = img.height * scale;
      imgX = (canvas.width - imgW) / 2;
      imgY = 250;
      
      // Sombra para la foto
      ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
      ctx.shadowBlur = 20;
      ctx.shadowOffsetX = 0;
      ctx.shadowOffsetY = 8;
      ctx.drawImage(img, imgX, imgY, imgW, imgH);
      ctx.shadowColor = 'transparent';
      
      // Marco blanco para la foto
      ctx.strokeStyle = 'rgba(255, 255, 255, 0.9)';
      ctx.lineWidth = 8;
      ctx.strokeRect(imgX - 4, imgY - 4, imgW + 8, imgH + 8);
      
      // Marco dorado interior para la foto
      ctx.strokeStyle = 'rgba(218, 165, 32, 0.6)';
      ctx.lineWidth = 2;
      ctx.strokeRect(imgX + 4, imgY + 4, imgW - 8, imgH - 8);

      // Paloma espiritual mejorada
      drawDove(canvas.width/2, imgY + imgH + 110, 1.5);

      // Textos de invitación
      ctx.textAlign = 'center';
      ctx.fillStyle = '#333';
      ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';
      ctx.shadowBlur = 3;
      ctx.shadowOffsetX = 0;
      ctx.shadowOffsetY = 1;
      
      ctx.font = 'italic 22px "Georgia", serif';
      ctx.fillStyle = 'rgba(50, 50, 70, 0.8)';
      ctx.fillText('Con inmensa alegría, queremos compartir contigo', canvas.width/2, imgY + imgH + 180);
      ctx.fillText('un momento muy especial en nuestras vidas.', canvas.width/2, imgY + imgH + 210);
      
      // Detalles del evento
      ctx.font = '24px "Arial", sans-serif';
      ctx.fillStyle = '#333';
      ctx.fillText('Fecha: Viernes, 6 de septiembre de 2025', canvas.width/2, imgY + imgH + 260);
      ctx.fillText('Hora: 12:00 del día', canvas.width/2, imgY + imgH + 290);
      ctx.fillText('Lugar: Parroquia de San Ginés', canvas.width/2, imgY + imgH + 320);
      ctx.fillText('Dirección: Plaza de las Palmas, 1', canvas.width/2, imgY + imgH + 350);
      
      // Padres y padrinos
      ctx.font = 'bold 22px "Georgia", serif';
      ctx.fillText('Padres: José y Victoria', canvas.width/2 - 100, imgY + imgH + 400);
      ctx.fillText('Padrinos: Humberto y Ángela', canvas.width/2 + 100, imgY + imgH + 400);

      // Detalles adicionales y separador
      drawDivider(canvas.width/2, imgY + imgH + 430, 300);
      
      // Mensaje final
      ctx.font = 'italic 20px "Georgia", serif';
      ctx.fillStyle = 'rgba(50, 50, 70, 0.7)';
      ctx.fillText('Celebra con nosotros este momento lleno de fe,', canvas.width/2, imgY + imgH + 460);
      ctx.fillText('amor y esperanza, en el que una nueva luz', canvas.width/2, imgY + imgH + 485);
      ctx.fillText('se enciende en nuestro camino.', canvas.width/2, imgY + imgH + 510);
      
      // Firma final
      ctx.font = 'italic 20px "Georgia", serif';
      ctx.fillStyle = '#888';
      ctx.fillText('Los Padres', canvas.width/2, canvas.height - 80);
    }
    
    // Función para dibujar paloma más detallada
    function drawDove(x, y, scale) {
      ctx.save();
      ctx.translate(x, y);
      ctx.scale(scale, scale);
      
      // Cuerpo base
      ctx.fillStyle = 'rgba(255, 255, 255, 0.85)';
      
      // Cuerpo
      ctx.beginPath();
      ctx.ellipse(0, 0, 20, 15, 0, 0, Math.PI * 2);
      ctx.fill();
      
      // Cabeza
      ctx.beginPath();
      ctx.ellipse(-15, -5, 10, 8, -0.3, 0, Math.PI * 2);
      ctx.fill();
      
      // Pico
      ctx.fillStyle = 'rgba(255, 220, 150, 0.9)';
      ctx.beginPath();
      ctx.moveTo(-25, -5);
      ctx.lineTo(-28, -3);
      ctx.lineTo(-25, -1);
      ctx.fill();
      
      // Alas
      ctx.fillStyle = 'rgba(255, 255, 255, 0.85)';
      // Ala izquierda
      ctx.beginPath();
      ctx.moveTo(-5, 0);
      ctx.quadraticCurveTo(-20, 20, 0, 25);
      ctx.quadraticCurveTo(5, 10, -5, 0);
      ctx.fill();
      
      // Ala derecha
      ctx.beginPath();
      ctx.moveTo(5, 0);
      ctx.quadraticCurveTo(30, 15, 25, 25);
      ctx.quadraticCurveTo(10, 15, 5, 0);
      ctx.fill();
      
      // Detalle ojo
      ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
      ctx.beginPath();
      ctx.arc(-20, -5, 1.5, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.restore();
    }
    
    // Función para dibujar un separador decorativo
    function drawDivider(x, y, width) {
      ctx.save();
      ctx.translate(x, y);
      
      // Línea central
      ctx.strokeStyle = 'rgba(180, 180, 200, 0.5)';
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.moveTo(-width/2, 0);
      ctx.lineTo(width/2, 0);
      ctx.stroke();
      
      // Pequeño ornamento central
      ctx.fillStyle = 'rgba(180, 180, 200, 0.5)';
      ctx.beginPath();
      ctx.arc(0, 0, 4, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.restore();
    }

    // Dibuja borde dorado parpadeante
    function drawGoldenFlicker(alpha, lineW) {
      ctx.save();
      ctx.strokeStyle = `rgba(218, 165, 32, ${alpha})`;
      ctx.lineWidth = lineW;
      ctx.strokeRect(imgX - 10, imgY - 10, imgW + 20, imgH + 20);
      ctx.restore();
    }

    // Dibuja partículas alrededor de la imagen
    function drawParticles(time) {
      const particleCount = 12;
      const radius = imgW/2 + 30;
      
      ctx.save();
      ctx.translate(imgX + imgW/2, imgY + imgH/2);
      
      for (let i = 0; i < particleCount; i++) {
        const angle = (i / particleCount) * Math.PI * 2 + time * 0.0005;
        const x = Math.cos(angle) * radius;
        const y = Math.sin(angle) * radius;
        const size = 2 + Math.sin(time * 0.001 + i) * 2;
        
        ctx.fillStyle = `rgba(255, 215, 0, ${0.3 + Math.sin(time * 0.002 + i) * 0.2})`;
        ctx.beginPath();
        ctx.arc(x, y, size, 0, Math.PI * 2);
        ctx.fill();
      }
      
      ctx.restore();
    }

    // Animación
    let lastTime = 0;
    function animate(time) {
      // Limpiar canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Fondo y bordes
      drawBackground();
      drawCornerCrosses();

      // Elementos fijos
      drawStaticElements();

      // Parámetros aleatorios para parpadeo
      const alpha = 0.4 + Math.sin(time * 0.001) * 0.3;       // entre 0.1 y 0.7
      const lineW = 4 + Math.sin(time * 0.002) * 2;           // entre 2 y 6px

      // Dibuja borde dorado
      drawGoldenFlicker(alpha, lineW);
      
      // Partículas decorativas
      drawParticles(time);

      requestAnimationFrame(animate);
    }

    // Función para iniciar la animación
    function startAnimation() {
      console.log('Starting animation');
      animate(0);
    }
    
    // Inicia la animación y añade detección de problemas
    startAnimation();
    
    // Evento adicional para detectar problemas
    window.addEventListener('load', () => {
      console.log('Window loaded');
      setTimeout(() => {
        if (!canvas.getContext) {
          console.error('Canvas context not available');
          document.getElementById('fallbackMessage').style.display = 'block';
          canvas.style.display = 'none';
        } else {
          try {
            // Verificar si el canvas está pintando correctamente
            const imageData = ctx.getImageData(0, 0, 10, 10).data;
            let hasData = false;
            for (let i = 0; i < imageData.length; i++) {
              if (imageData[i] !== 0) {
                hasData = true;
                break;
              }
            }
            
            if (!hasData) {
              console.warn('Canvas appears to be empty - trying again');
              startAnimation();
            }
          } catch (e) {
            console.error('Error in canvas rendering:', e);
            document.getElementById('fallbackMessage').style.display = 'block';
          }
        }
      }, 500);
    });
  </script>
</body>
</html>
