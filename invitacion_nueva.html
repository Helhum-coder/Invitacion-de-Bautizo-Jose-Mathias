<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Invitaci√≥n Bautizo - Jose Mathias (Offline)</title>
  <style>
    @font-face {
      font-family: 'Georgia-Offline';
      src: local('Georgia'), local('Times New Roman'), local('Times'), local('serif');
      font-display: swap;
      font-weight: normal;
      font-style: normal;
    }
    
    @font-face {
      font-family: 'Georgia-Offline';
      src: local('Georgia Bold'), local('Georgia-Bold'), local('Times New Roman Bold'), local('Times-Bold');
      font-display: swap;
      font-weight: bold;
      font-style: normal;
    }
    
    @font-face {
      font-family: 'Georgia-Offline';
      src: local('Georgia Italic'), local('Georgia-Italic'), local('Times New Roman Italic'), local('Times-Italic');
      font-display: swap;
      font-weight: normal;
      font-style: italic;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      font-family: 'Georgia-Offline', Georgia, 'Times New Roman', Times, serif;
      background: linear-gradient(135deg, #7aa1f2 0%, #a9c5ff 50%, #cfd9ff 100%);
      background-size: 400% 400%;
      animation: backgroundShift 20s ease infinite;
      padding: 20px;
      overflow-x: hidden;
      overflow-y: auto;
      /* Ensure offline compatibility */
      -webkit-font-feature-settings: "kern" 1;
      font-feature-settings: "kern" 1;
      text-rendering: optimizeLegibility;
    }
    
    @keyframes backgroundShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    
    .container {
      position: relative;
      max-width: 800px;
      width: 100%;
      margin: 20px auto;
      padding-bottom: 60px; /* Increased padding for better scrolling */
    }
    
    canvas {
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.15);
      border-radius: 10px;
      max-width: 100%;
      height: auto;
      background: white;
    }

    /* Modal styles para la foto */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      animation: modalFadeIn 0.3s ease-out;
    }

    .modal.show {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    @keyframes modalFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-content {
      position: relative;
      max-width: 90%;
      max-height: 90%;
      animation: modalSlideIn 0.3s ease-out;
    }

    @keyframes modalSlideIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .modal-image {
      width: 100%;
      height: auto;
      border-radius: 15px;
      box-shadow: 0 0 50px rgba(255, 255, 255, 0.3);
      border: 5px solid rgba(255, 255, 255, 0.8);
    }

    .modal-close {
      position: absolute;
      top: -15px;
      right: -15px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    .modal-close:hover {
      background: #ff6b6b;
      color: white;
      transform: scale(1.1);
    }

    .modal-caption {
      position: absolute;
      bottom: -60px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 255, 255, 0.95);
      color: #333;
      padding: 15px 25px;
      border-radius: 25px;
      font-family: 'Georgia-Offline', Georgia, 'Times New Roman', Times, serif;
      font-size: 18px;
      font-weight: bold;
      text-align: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      white-space: nowrap;
    }

    /* Responsive modal */
    @media screen and (max-width: 768px) {
      .modal-content {
        max-width: 95%;
        max-height: 80%;
      }
      
      .modal-caption {
        font-size: 16px;
        padding: 12px 20px;
        bottom: -50px;
      }
      
      .modal-close {
        width: 35px;
        height: 35px;
        font-size: 20px;
      }
    }

    /* Responsive styles */
    @media screen and (max-width: 840px) {
      .container {
        width: 95%;
        padding-bottom: 40px;
      }
      
      body {
        padding: 10px;
      }
    }
    
    /* Offline status indicator */
    .offline-ready {
      position: fixed;
      top: 10px;
      right: 10px;
      background: rgba(76, 175, 80, 0.9);
      color: white;
      padding: 6px 12px;
      border-radius: 15px;
      font-size: 12px;
      font-weight: bold;
      z-index: 999;
      opacity: 0;
      transition: opacity 0.3s ease;
      font-family: 'Georgia-Offline', Georgia, 'Times New Roman', Times, serif;
    }

    .offline-ready.show {
      opacity: 1;
    }
    
    /* Ensure proper rendering without external dependencies */
    * {
      -webkit-box-sizing: border-box;
      -moz-box-sizing: border-box;
      box-sizing: border-box;
    }
    
    /* Fallback for missing fonts */
    .fallback-text {
      font-family: Georgia, 'Times New Roman', Times, serif !important;
    }
  </style>
</head>
<body>
<audio autoplay loop>
    <source src="preludio.mp3" type="audio/mpeg">
    Tu navegador no soporta el elemento de audio.
</audio>
  <div class="offline-ready" id="offlineIndicator">
    üì± Funciona Sin Internet
  </div>
  
  <div class="container">
    <canvas id="baptismCanvas" width="800" height="1200"></canvas>
    
    <!-- Modal para mostrar la foto en grande -->
    <div id="photoModal" class="modal">
      <div class="modal-content">
        <button class="modal-close" onclick="closePhotoModal()">&times;</button>
        <img id="modalImage" class="modal-image" src="iCloud Photos from Helbs LozRoj/89403b46-9e13-4d3e-b6f6-b17c5359e2e6.jpg" alt="Jose Mathias">
        <div class="modal-caption">Jose Mathias - Nuestro peque√±o √°ngel</div>
      </div>
    </div>
    
    <noscript>
      <div style="text-align: center; padding: 20px; color: #333; background: white; border-radius: 10px; margin-bottom: 20px;">
        <h1 style="font-family: Georgia, 'Times New Roman', Times, serif;">Invitaci√≥n Bautizo de Jose Mathias</h1>
        <p style="font-style: italic; font-family: Georgia, 'Times New Roman', Times, serif;">Con inmensa alegr√≠a, queremos compartir contigo un momento muy especial en nuestras vidas.</p>
        <p style="font-family: Georgia, 'Times New Roman', Times, serif;"><strong>El Bautizo de nuestro hijo, Jose Mathias.</strong></p>
        <img src="iCloud Photos from Helbs LozRoj/89403b46-9e13-4d3e-b6f6-b17c5359e2e6.jpg" alt="Jose Mathias" style="max-width: 100%; height: auto; margin: 20px 0; border: 8px solid white; box-shadow: 0 4px 8px rgba(0,0,0,0.2); border-radius: 10px;">
        <p style="font-family: Georgia, 'Times New Roman', Times, serif;"><strong>Fecha:</strong> S√°bado, 6 de septiembre de 2025<br>
        <strong>Hora:</strong> 12:00 del d√≠a<br>
        <strong>Lugar:</strong> Parroquia de San Gin√©s<br>
        <strong>Direcci√≥n:</strong> Plaza de las Palmas, 1</p>
        <p style="font-family: Georgia, 'Times New Roman', Times, serif;"><strong>Padres:</strong> Jos√© y Victoria<br>
        <strong>Padrinos:</strong> Humberto y √Ångela</p>
        <p style="font-style: italic; font-family: Georgia, 'Times New Roman', Times, serif;">Celebra con nosotros este momento lleno de fe, amor y esperanza, en el que una nueva luz se enciende en nuestro camino.</p>
        <div style="margin-top: 20px; padding: 10px; background: rgba(76, 175, 80, 0.1); border-radius: 5px; font-family: Georgia, 'Times New Roman', Times, serif;">
          ‚úÖ Esta invitaci√≥n funciona completamente sin conexi√≥n a internet
        </div>
      </div>
    </noscript>
  </div>

  <script>
    console.log('üé® Iniciando invitaci√≥n de bautizo (MODO OFFLINE)...');
    
    // Offline status tracking
    let isOfflineMode = true;
    
    // Show offline indicator
    function showOfflineStatus() {
      const indicator = document.getElementById('offlineIndicator');
      if (indicator) {
        indicator.classList.add('show');
        setTimeout(() => {
          indicator.classList.remove('show');
        }, 3000);
      }
    }
    
    // Initialize offline status
    setTimeout(showOfflineStatus, 500);
    
    // Verificar que el navegador soporte las funcionalidades necesarias
    if (!window.HTMLCanvasElement) {
      console.warn('‚ö†Ô∏è Canvas no soportado, mostrando versi√≥n b√°sica');
      const noscript = document.querySelector('noscript');
      if (noscript) noscript.style.display = 'block';
    }
    
    const canvas = document.getElementById('baptismCanvas');
    const ctx = canvas ? canvas.getContext('2d') : null;
    
    // Variables globales
    let img = null;
    let imageLoaded = false;
    let animationId = null;
    let imgX, imgY, imgW, imgH; // Variables para la posici√≥n de la imagen
    
    console.log('üì± Estado: MODO OFFLINE - Sin dependencias externas');
    console.log('üì∂ Estado de conexi√≥n:', navigator.onLine ? 'Online (opcional)' : 'Offline (funcional)');
    
    // Funci√≥n para redimensionar canvas
    function resizeCanvas() {
      const container = document.querySelector('.container');
      const containerWidth = container.clientWidth;
      
      if (containerWidth < 800) {
        const aspectRatio = canvas.height / canvas.width;
        canvas.style.width = containerWidth + 'px';
        canvas.style.height = (containerWidth * aspectRatio) + 'px';
      } else {
        canvas.style.width = '';
        canvas.style.height = '';
      }
    }
    
    // Cargar imagen
    function loadImage() {
      console.log('üì∑ Cargando imagen...');
      img = new Image();
      img.onload = function() {
        imageLoaded = true;
        console.log('‚úÖ Imagen cargada exitosamente');
      };
      img.onerror = function() {
        console.log('‚ùå Error cargando imagen, continuando sin ella (modo offline compatible)');
        imageLoaded = false;
        // Create fallback placeholder
        createImagePlaceholder();
      };
      img.src = 'iCloud Photos from Helbs LozRoj/89403b46-9e13-4d3e-b6f6-b17c5359e2e6.jpg';
    }
    
    // Create image placeholder for offline mode
    function createImagePlaceholder() {
      // This will be handled in the drawing function
      console.log('üì∑ Usando placeholder offline para la imagen');
    }
    
    // Funci√≥n para dibujar nubes
    function drawCloud(x, y, size, time, seed) {
      ctx.save();
      
      const bubbleCount = 6;
      const brightness = 250 + Math.sin(time * 0.001 + seed) * 5;
      const alpha = 0.8 + Math.sin(time * 0.002 + seed) * 0.1;
      
      for (let i = 0; i < bubbleCount; i++) {
        const angle = (i / bubbleCount) * Math.PI * 2;
        const distance = size * 0.4 * (0.6 + Math.sin(seed + i) * 0.4);
        const bubblex = x + Math.cos(angle) * distance + Math.sin(time * 0.0005 + i + seed) * 8;
        const bubbley = y + Math.sin(angle) * distance * 0.6 + Math.cos(time * 0.0004 + i + seed) * 5;
        
        const bubbleSize = (0.4 + Math.sin(seed + i * 4) * 0.3) * size;
        
        const cloudGrad = ctx.createRadialGradient(
          bubblex, bubbley, 0,
          bubblex, bubbley, bubbleSize
        );
        cloudGrad.addColorStop(0, `rgba(${brightness}, ${brightness}, ${brightness}, ${alpha})`);
        cloudGrad.addColorStop(0.7, `rgba(${brightness-5}, ${brightness-5}, ${brightness}, ${alpha*0.9})`);
        cloudGrad.addColorStop(1, `rgba(${brightness-10}, ${brightness-10}, ${brightness-5}, 0)`);
        
        ctx.fillStyle = cloudGrad;
        ctx.beginPath();
        ctx.arc(bubblex, bubbley, bubbleSize, 0, Math.PI * 2);
        ctx.fill();
      }
      
      ctx.restore();
    }
    
    // Funci√≥n para dibujar fondo celestial
    function drawBackground(time = 0) {
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      
      // Degradado principal celestial azul
      const skyGrad = ctx.createLinearGradient(0, 0, 0, canvas.height);
      skyGrad.addColorStop(0, `rgba(135, 206, 250, ${0.9 + Math.sin(time * 0.0005) * 0.1})`);
      skyGrad.addColorStop(0.6, `rgba(176, 196, 255, ${0.9 + Math.sin(time * 0.0003) * 0.1})`);
      skyGrad.addColorStop(1, `rgba(230, 230, 255, ${0.95 + Math.sin(time * 0.0004) * 0.05})`);
      
      ctx.fillStyle = skyGrad;
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      // Dibujar nubes danzantes
      for (let i = 0; i < 8; i++) {
        const cloudSeed = i * 1000;
        const cloudX = centerX + (i - 3.5) * 90 + Math.sin(time * 0.0002 + i) * 40;
        const cloudY = 80 + (i % 3) * 80 + Math.cos(time * 0.0003 + i) * 25;
        const cloudSize = 50 + (i % 3) * 20 + Math.sin(time * 0.0004 + i) * 15;
        
        drawCloud(cloudX, cloudY, cloudSize, time, cloudSeed);
      }
      
      // Efecto de luz celestial
      const celestialGlow = ctx.createRadialGradient(
        centerX, centerY * 0.3, 0,
        centerX, centerY * 0.3, canvas.height * 0.8
      );
      celestialGlow.addColorStop(0, `rgba(255, 255, 255, ${0.2 + Math.sin(time * 0.001) * 0.1})`);
      celestialGlow.addColorStop(0.3, `rgba(255, 250, 240, ${0.15 + Math.sin(time * 0.001) * 0.05})`);
      celestialGlow.addColorStop(1, 'rgba(255, 250, 240, 0)');
      
      ctx.fillStyle = celestialGlow;
      ctx.fillRect(0, 0, canvas.width, canvas.height);
    }
    
    // Funci√≥n para dibujar cruces celestiales
    function drawCornerCrosses(time = 0) {
      const crossSize = 32;
      const margin = 60;
      
      function drawCross(x, y, index) {
        const pulseIntensity = 0.15;
        const pulseFrequency = 0.001;
        const pulseFactor = 1 + Math.sin(time * pulseFrequency + index) * pulseIntensity;
        
        // Resplandor celestial
        const glowSize = crossSize * 1.3 * pulseFactor;
        const glow = ctx.createRadialGradient(x, y, 0, x, y, glowSize);
        glow.addColorStop(0, `rgba(255, 255, 255, ${0.6 * pulseFactor})`);
        glow.addColorStop(0.5, `rgba(200, 220, 255, ${0.4 * pulseFactor})`);
        glow.addColorStop(1, 'rgba(180, 200, 255, 0)');
        
        ctx.fillStyle = glow;
        ctx.beginPath();
        ctx.arc(x, y, glowSize, 0, Math.PI * 2);
        ctx.fill();
        
        // Cruz principal con gradiente celestial
        const gradientCross = ctx.createLinearGradient(
          x - crossSize/2, y - crossSize/2, 
          x + crossSize/2, y + crossSize/2
        );
        gradientCross.addColorStop(0, `rgba(220, 230, 255, ${0.9 * pulseFactor})`);
        gradientCross.addColorStop(0.5, `rgba(200, 220, 250, ${0.8 * pulseFactor})`);
        gradientCross.addColorStop(1, `rgba(180, 200, 240, ${0.7 * pulseFactor})`);
        
        ctx.strokeStyle = gradientCross;
        ctx.lineWidth = 3 * pulseFactor;
        ctx.lineCap = 'round';
        
        ctx.beginPath();
        ctx.moveTo(x, y - crossSize/2);
        ctx.lineTo(x, y + crossSize/2);
        ctx.moveTo(x - crossSize/2, y);
        ctx.lineTo(x + crossSize/2, y);
        ctx.stroke();
        
        // Centro brillante
        const centerGlow = ctx.createRadialGradient(x, y, 0, x, y, 5 * pulseFactor);
        centerGlow.addColorStop(0, 'rgba(255, 255, 255, 1)');
        centerGlow.addColorStop(0.5, 'rgba(240, 250, 255, 0.8)');
        centerGlow.addColorStop(1, 'rgba(220, 240, 255, 0)');
        
        ctx.fillStyle = centerGlow;
        ctx.beginPath();
        ctx.arc(x, y, 5 * pulseFactor, 0, Math.PI * 2);
        ctx.fill();
      }
      
      ctx.save();
      drawCross(margin, margin, 0);
      drawCross(canvas.width - margin, margin, 1);
      drawCross(margin, canvas.height - margin, 2);
      drawCross(canvas.width - margin, canvas.height - margin, 3);
      ctx.restore();
    }
    
    // Funci√≥n para dibujar elementos est√°ticos
    function drawStaticElements(time = 0) {
      // T√≠tulo principal con sombra
      ctx.textAlign = 'center';
      ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
      ctx.shadowBlur = 4;
      ctx.shadowOffsetX = 2;
      ctx.shadowOffsetY = 2;
      
      ctx.fillStyle = '#2c3e50';
      ctx.font = 'bold 42px Georgia, serif';
      ctx.fillText('Bautizo', canvas.width/2, 120);
      
      // Nombre del beb√©
      ctx.font = 'italic bold 52px Georgia, serif';
      ctx.fillStyle = '#34495e';
      ctx.fillText('Jose Mathias', canvas.width/2, 180);
      
      // Resetear sombra
      ctx.shadowColor = 'transparent';
      ctx.shadowBlur = 0;
      ctx.shadowOffsetX = 0;
      ctx.shadowOffsetY = 0;
      
      // Imagen del beb√©
      if (imageLoaded && img) {
        const targetW = 400;
        const scale = targetW / img.width;
        imgW = targetW;
        imgH = img.height * scale;
        imgX = (canvas.width - imgW) / 2;
        imgY = 220;
        
        // Sombra para la imagen
        ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
        ctx.shadowBlur = 15;
        ctx.shadowOffsetX = 5;
        ctx.shadowOffsetY = 5;
        
        // Dibujar imagen
        ctx.drawImage(img, imgX, imgY, imgW, imgH);
        
        // Marco dorado animado
        ctx.shadowColor = 'transparent';
        ctx.shadowBlur = 0;
        ctx.shadowOffsetX = 0;
        ctx.shadowOffsetY = 0;
        
        const frameGrad = ctx.createLinearGradient(imgX - 10, imgY - 10, imgX + imgW + 10, imgY + imgH + 10);
        frameGrad.addColorStop(0, 'rgba(255, 215, 0, 0.9)');
        frameGrad.addColorStop(0.5, 'rgba(255, 255, 0, 0.7)');
        frameGrad.addColorStop(1, 'rgba(255, 215, 0, 0.9)');
        
        ctx.strokeStyle = frameGrad;
        ctx.lineWidth = 6;
        ctx.strokeRect(imgX - 8, imgY - 8, imgW + 16, imgH + 16);
        
        // Marco interior
        ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';
        ctx.lineWidth = 2;
        ctx.strokeRect(imgX - 4, imgY - 4, imgW + 8, imgH + 8);
        
        // Indicador de que se puede hacer clic (√≠cono de lupa pulsante)
        const hintAlpha = 0.6 + Math.sin(time * 0.003) * 0.4;
        ctx.save();
        ctx.globalAlpha = hintAlpha;
        
        const iconX = imgX + imgW - 30;
        const iconY = imgY + 25;
        
        // Fondo del √≠cono
        ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
        ctx.beginPath();
        ctx.arc(iconX, iconY, 15, 0, Math.PI * 2);
        ctx.fill();
        
        // √çcono de lupa
        ctx.strokeStyle = 'white';
        ctx.fillStyle = 'white';
        ctx.lineWidth = 2;
        
        ctx.beginPath();
        ctx.arc(iconX - 3, iconY - 3, 6, 0, Math.PI * 2);
        ctx.stroke();
        
        ctx.beginPath();
        ctx.moveTo(iconX + 2, iconY + 2);
        ctx.lineTo(iconX + 6, iconY + 6);
        ctx.stroke();
        
        // Signo +
        ctx.lineWidth = 1.5;
        ctx.beginPath();
        ctx.moveTo(iconX + 8, iconY - 8);
        ctx.lineTo(iconX + 12, iconY - 8);
        ctx.moveTo(iconX + 10, iconY - 10);
        ctx.lineTo(iconX + 10, iconY - 6);
        ctx.stroke();
        
        ctx.restore();
        
        // Informaci√≥n del evento
        const infoY = imgY + imgH + 80;
        
        ctx.font = '22px Georgia, serif';
        ctx.fillStyle = '#2c3e50';
        ctx.fillText('S√°bado, 6 de septiembre de 2025', canvas.width/2, infoY);
        ctx.fillText('12:00 del d√≠a', canvas.width/2, infoY + 35);
        
        ctx.font = '20px Georgia, serif';
        ctx.fillText('Parroquia de San Gin√©s', canvas.width/2, infoY + 80);
        ctx.fillText('Plaza de las Palmas, 1', canvas.width/2, infoY + 110);
        
        ctx.font = '18px Georgia, serif';
        ctx.fillStyle = '#34495e';
        ctx.fillText('Padres: Jos√© y Victoria', canvas.width/2, infoY + 150);
        ctx.fillText('Padrinos: Humberto y √Ångela', canvas.width/2, infoY + 180);
        
        ctx.font = 'italic 16px Georgia, serif';
        ctx.fillStyle = '#555';
        const messageY = infoY + 220;
        ctx.fillText('Celebra con nosotros este momento lleno de fe, amor y esperanza,', canvas.width/2, messageY);
        ctx.fillText('en el que una nueva luz se enciende en nuestro camino.', canvas.width/2, messageY + 25);
        
      } else {
        // Placeholder offline mejorado si no hay imagen
        const placeholderX = 200;
        const placeholderY = 220;
        const placeholderW = 400;
        const placeholderH = 300;
        
        // Fondo con gradiente
        const placeholderGrad = ctx.createLinearGradient(
          placeholderX, placeholderY,
          placeholderX + placeholderW, placeholderY + placeholderH
        );
        placeholderGrad.addColorStop(0, '#f8f9fa');
        placeholderGrad.addColorStop(1, '#e9ecef');
        
        ctx.fillStyle = placeholderGrad;
        ctx.fillRect(placeholderX, placeholderY, placeholderW, placeholderH);
        
        // Borde dorado
        ctx.strokeStyle = '#FFD700';
        ctx.lineWidth = 6;
        ctx.strokeRect(placeholderX - 3, placeholderY - 3, placeholderW + 6, placeholderH + 6);
        
        // Texto del placeholder
        ctx.fillStyle = '#666';
        ctx.font = '32px Georgia, serif';
        ctx.textAlign = 'center';
        ctx.fillText('üë∂', canvas.width/2, placeholderY + placeholderH/2 - 20);
        
        ctx.font = '20px Georgia, serif';
        ctx.fillText('Jose Mathias', canvas.width/2, placeholderY + placeholderH/2 + 20);
        
        ctx.font = '14px Georgia, serif';
        ctx.fillStyle = '#999';
        ctx.fillText('Imagen en modo offline', canvas.width/2, placeholderY + placeholderH/2 + 45);
        
        // Set placeholder coordinates for click detection
        imgX = placeholderX;
        imgY = placeholderY;
        imgW = placeholderW;
        imgH = placeholderH;
        
        // Informaci√≥n del evento
        const infoY = 620;
        
        ctx.font = '22px Georgia, serif';
        ctx.fillStyle = '#2c3e50';
        ctx.fillText('S√°bado, 6 de septiembre de 2025', canvas.width/2, infoY);
        ctx.fillText('12:00 del d√≠a', canvas.width/2, infoY + 35);
        
        ctx.font = '20px Georgia, serif';
        ctx.fillText('Parroquia de San Gin√©s', canvas.width/2, infoY + 80);
        ctx.fillText('Plaza de las Palmas, 1', canvas.width/2, infoY + 110);
        
        ctx.font = '18px Georgia, serif';
        ctx.fillStyle = '#34495e';
        ctx.fillText('Padres: Jos√© y Victoria', canvas.width/2, infoY + 150);
        ctx.fillText('Padrinos: Humberto y √Ångela', canvas.width/2, infoY + 180);
        
        ctx.font = 'italic 16px Georgia, serif';
        ctx.fillStyle = '#555';
        const messageY = infoY + 220;
        ctx.fillText('Celebra con nosotros este momento lleno de fe, amor y esperanza,', canvas.width/2, messageY);
        ctx.fillText('en el que una nueva luz se enciende en nuestro camino.', canvas.width/2, messageY + 25);
      }
    }
    
    // Funci√≥n de animaci√≥n principal
    function animate(time) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      drawBackground(time);
      drawCornerCrosses(time);
      drawStaticElements(time);
      
      animationId = requestAnimationFrame(animate);
    }
    
    // Funciones para el modal
    function openPhotoModal() {
      console.log('üñºÔ∏è Abriendo modal de foto');
      const modal = document.getElementById('photoModal');
      modal.classList.add('show');
      document.body.style.overflow = 'hidden';
    }
    
    function closePhotoModal() {
      console.log('‚ùå Cerrando modal de foto');
      const modal = document.getElementById('photoModal');
      modal.classList.remove('show');
      document.body.style.overflow = 'auto';
    }
    
    // Event listeners para el modal
    document.getElementById('photoModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closePhotoModal();
      }
    });
    
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closePhotoModal();
      }
    });
    
    // Detectar clics en el canvas
    canvas.addEventListener('click', function(e) {
      if (!img || !imageLoaded || !imgX || !imgY || !imgW || !imgH) return;
      
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height / rect.height;
      
      const clickX = (e.clientX - rect.left) * scaleX;
      const clickY = (e.clientY - rect.top) * scaleY;
      
      console.log('üñ±Ô∏è Clic en:', clickX, clickY);
      console.log('üìç Imagen en:', imgX, imgY, imgW, imgH);
      
      // Verificar si el clic est√° dentro de la imagen
      if (clickX >= imgX && clickX <= imgX + imgW && 
          clickY >= imgY && clickY <= imgY + imgH) {
        console.log('üéØ Clic en la imagen!');
        openPhotoModal();
      }
    });
    
    // Cambiar cursor cuando est√© sobre la foto
    canvas.addEventListener('mousemove', function(e) {
      if (!img || !imageLoaded || !imgX || !imgY || !imgW || !imgH) return;
      
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height / rect.height;
      
      const mouseX = (e.clientX - rect.left) * scaleX;
      const mouseY = (e.clientY - rect.top) * scaleY;
      
      if (mouseX >= imgX && mouseX <= imgX + imgW && 
          mouseY >= imgY && mouseY <= imgY + imgH) {
        canvas.style.cursor = 'pointer';
      } else {
        canvas.style.cursor = 'default';
      }
    });
    
    // Funci√≥n de inicializaci√≥n
    function init() {
      console.log('üöÄ Iniciando invitaci√≥n de bautizo OFFLINE...');
      
      // Configurar canvas responsive
      resizeCanvas();
      window.addEventListener('resize', resizeCanvas);
      
      // Cargar imagen
      loadImage();
      
      // Iniciar animaci√≥n
      animate(0);
      
      console.log('‚úÖ Invitaci√≥n offline iniciada exitosamente - Sin dependencias externas');
    }
    
    // Prevent any network requests
    window.addEventListener('error', function(e) {
      if (e.target && (e.target.tagName === 'IMG' || e.target.tagName === 'SCRIPT' || e.target.tagName === 'LINK')) {
        console.log('üö´ Bloqueando solicitud externa:', e.target.src || e.target.href);
        e.preventDefault();
        return false;
      }
    }, true);
    
    // Disable any external font loading
    if ('FontFace' in window) {
      window.FontFace = function() {
        console.log('üö´ Bloqueando carga de fuentes externas - usando fuentes locales');
        return { load: () => Promise.reject() };
      };
    }
    
    // Hacer las funciones del modal globales
    window.openPhotoModal = openPhotoModal;
    window.closePhotoModal = closePhotoModal;
    
    // Inicializar cuando est√© listo
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
    
    // Fallback adicional
    setTimeout(() => {
      if (!animationId) {
        console.log('üîÑ Iniciando fallback...');
        init();
      }
    }, 100);
    
  </script>
</body>
</html>
